---------------------------------------
Immich installation / Nextcloud / Minio
Replace drsean by your user.
---------------------------------------
Steps 4 and 5 just if you want to configure a S3 service as primary storage.

1. Create your directories.

mkdir /var/www/html
mkdir /home/drsean/immich
cd /home/drsean/immich
mkdir /home/drsean/immich/data

2. Get configuration files from GitHub

        wget https://raw.githubusercontent.com/CarlosVelezR/Cloud-Personal/QA/docker-compose.yml

        wget https://raw.githubusercontent.com/CarlosVelezR/Cloud-Personal/QA/.env

        wget https://raw.githubusercontent.com/CarlosVelezR/Cloud-Personal/QA/config.php
    

3. Execute docker compose file.

docker compose up -d --force-recreate

4. Create a bucket in your minio instance, you've to login in your minio console with the credentials setted in your .env file. (http://192.168.145.145:9001).

5. Create an Access key in your minio intance.

6. Move the config file 

mv config.php /var/snap/docker/common/var-lib-docker/volumes/immich_nextcloud/_data/config/

7. Add your bucket name and access key to the config.php file using VIM.

vi /var/snap/docker/common/var-lib-docker/volumes/immich_nextcloud/_data/config/config.php

8. Set write and read permissions.

chmod 777 /var/snap/docker/common/var-lib-docker/volumes/immich_nextcloud/_data/config/config.php

chmod 777 /var/snap/docker/common/var-lib-docker/volumes/immich_minio_data/_data/immichbucket

Done!

You can test your services.

http://192.168.145.145:8080 -> NextCloud to manage your files. (User credentials setted in your .env file)
http://192.168.145.145:9001 -> Minio to manage your own S3 bucket. (User credentials setted in your .env file)
http://192.168.145.145:2283 -> Immich App to Store your photos. 

---------------------------------------------------------------------------------------------------------------------------
Uninstall Apps and Containers

docker stop $(docker ps -q)
docker system prune --all
docker volume prune
docker network prune

rm -r /home/drsean/immich

---------------------------------------------------------------------------------------------------------------------------

/var/snap/docker/common/var-lib-docker/volumes/immich_nextcloud/_data/config/config.php

Next Cloud Maintenance mode

Activate Maintenance mode: 

sudo -u www-data php "$ncdir/occ" maintenance:mode --on

Installation Path: 

/var/snap/docker/common/var-lib-docker/volumes/immich_minio_data/_data

NextCloud default log: 

/var/snap/docker/common/var-lib-docker/volumes/immich_nextcloud/_data/data/nextcloud.log

------ ver log CRON
tail -f /var/log/syslog | grep CRON